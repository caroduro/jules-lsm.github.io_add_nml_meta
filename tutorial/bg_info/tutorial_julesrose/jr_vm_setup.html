<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <meta name="description" content="JULES-Rose Tutorial">
        <meta name="author" content="JULES System Manager">
        <link rel="icon" href="jules_logo.png">
        <title>JULES VM setup</title>
        <!-- Bootstrap core CSS -->
        <link href="../etc/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <!-- Bootstrap theme -->
        <link href="../etc/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">
        <!-- Custom styles for this template -->
        <link href="general_theme.css" rel="stylesheet">
    </head>
    <body>
        <!-- Fixed navbar -->
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">JULES VM setup</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <!-- Add link to Homepage to training when created -->
                        <li class="active"><a href="#">Home</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Other material <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li class="dropdown-header">Quizzes</li>
                                <li><a href="precourse_quiz.html">Pre-course Quiz</a></li>
                                <li><a href="user_quiz.html">User Quiz</a></li>
                                <li><a href="developer_quiz.html">Developer Quiz</a></li>
                                <li><a href="developer_advanced_quiz.html">Developer Advanced Quiz</a></li>
                                <li role="separator" class="divider"></li>
                                <li class="dropdown-header">Tutorials and practical's</li>
                                <li><a href="jr_user.html">User</a></li>
                                <li><a href="jr_developer.html">Developer</a></li>
                                <li><a href="jr_developer_advanced.html">Developer Advanced</a></li>
                                <li role="separator" class="divider"></li>
                                <li class="dropdown-header">Help/info</li>
                                <li><a href="jr_glossary.html">Glossary List</a></li>
                                <li><a href="jr_links.html">Links</a></li>
                                <li><a href="jr_mqrg.html">My Quick Reference Guide</a></li>
                                <li><a href="jr_structures.html">JULES structures</a></li>
                                <li><a href="jr_rosecylc_setup.html">Rose/Cylc setup</a></li>
                                <li><a href="jr_jasmin_setup.html">JULES JASMIN setup</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <!--/.nav-collapse -->
            </div>
        </nav>
        <div class="container theme-showcase" role="main">
            <div class="jumbotron">
                <h1>VM setup</h1>
            </div>
                <br/>
                <br/>
                <h2>JULES Virtual Machine setup</h2>
            <div class="well">
                <p>JULES can be run on a Virtual Machine (VM).</p>
                <p>The metomi team at the Met Office provide a VM with FCM,
                    Rose and Cylc installed and configured.
                    To use the VM, follow the <a href="https://github.com/metomi/metomi-vms#metomi-vms">instructions</a> 
                    for the Ubuntu 14.04 VM.</p>
                <br/>
                <p>You will need root access to your laptop/computer to be able
                   to install of the software required:
                   <a href="https://www.virtualbox.org/">VirtualBox</a> and
                   <a href="https://www.vagrantup.com/">Vagrant</a> then you
                   need to download the metomi VM setup files from 
                   <a href="https://github.com/metomi/metomi-vms/archive/master.zip">github</a>.
                   Then extract the files, these will be put into a directory
                   called <code>metomi-vms-master</code>.
                   For Window 10 specific advice please read <a href="https://code.metoffice.gov.uk/trac/jules/wiki/JULESVirtualMachine#JULESdevelopmentusingavirtualmachine">JULES development using a virtual machine</a>.
                   I (Kerry Smout-Day) have only had experience installing and
                   running the VM on Mac's.
                </p>
              </div>
                <br/>
                <h2>VM JULES Data</h2>
            <div class="well">
                <p><a href="https://code.metoffice.gov.uk/trac/jules/wiki/JULESVirtualMachine#JULES-specificinstructions">VM JULES Data</a>
                   can be obtained by running the three scripts in the link.
                   You need to run <code>sudo install-jules-*</code> for all 
                   three of the scripts.
                </p>
                <br/>
                <p>The 
                <a href="https://github.com/metomi/metomi-vms/tree/master/usr/local/bin">location of the install-jules-* scripts on GitHub</a>
                  are provide by the link for full details if required.</p>
                <br/>
           </div>
                <h2>VM KGO</h2>
            <div class="well">
                <p>Known Good Output (KGO) is the good data that <code>nccmp</code> uses
                   to compare with the new output that the rose stem suite has created in the
                   current suite run.</p>
                <ol>
                    <li>
                     KGO_DIR=&lt;/jules/rose-stem-kgo/&gt;</li>
<li>                     VN=vn4.7_t??? #replace with the appropriate KGO version
</li>
<li>                     mkdir -p $KGO_DIR/$VN</li>
<li>                     JULES_TRUNK=&lt;path/to/jules/vn4.7/trunk&gt; #replace vn4.7 with the appropriate JULES version number</li>
                     <li>cd $JULES_TRUNK</li>
                     #This suite will fail, but do it anyway as we need to create the KGO
                     <li><code>rose stem --group=all --source=. -S HOUSEKEEPING=false --new</code></li>
                     <li>cd ~/cylc-run/trunk</li>
                     <li>cp work/1/loobos_*/output/* $KGO_DIR/$VN</li>
                     <li>cp work/1/gswp2_*/output/* $KGO_DIR/$VN</li>
                     <br/>
                     <p>Now rose stem should be configured for your site and
                         compliers.</p>
                     <li>Test rose stem <code>rose stem --group=all --source=. --new</code> You should have no failures this time.</li>
                </ol>
                <br/>
            </div>

                <h2>VM Other help</h2>
            <div class="well">
                <p>To start the VM for the first time:<br/>
<pre>
cd ~/metomi-vm=master

#Start the VM for the first ever time
vagrant up
#when run for the first time since installing this takes about 10-20 minutes depending on your internet connection speed.
#when it has completed the install it will shut itself down

#Start the VM after the the first ever time
vagrant up
#this takes about 2-5 mins
#you will be asked for your MOSRS password
&lt;enter your MOSRS password&gt;
#if you fail to enter your password correctly:
mosrs-cache-password
#this will allow you to try your password again.

#To quit the VM safely
vagrant halt
#or within the ssh session
sudo shutdown -h now

#To remove your VM and start again use the following command.
#This will delete all the files downloaded.
#Remember to commit any local changes back to the repositories before doing this# as all local files will also be deleted, this include any data analysis.
vagrant destroy
</pre>
                </p>
                <br/>
                <p>Helpful commands for the VM:
                  <ul>
                     <li>rose slv #to open rose bush</li>
                     <li>rose edit #to open the rose editor GUI</li>
                     <li>rose suite-shutdown --name=SUITE_NAME -- --now #to shutdown you suite</li>
                     <li>cylc scan -c #to see what suites you have running</li>
                     <li>cylc gscan #to see what suites you have running via the GUI</li>
                  </ul>
                </p>
            </div>
            <div class="container">
            </div>
            <hr/>
            <div class="container-fluid text-center">
                <div class="row">
                    <div class="col-md-12">
                        <address><small>
                            &copy; British Crown Copyright 2006-17
                            <a href="http://www.metoffice.gov.uk">Met Office</a>.<br />
                            This document is released under the British <a href=
                                "http://www.nationalarchives.gov.uk/doc/open-government-licence/" rel=
                                "license">Open Government Licence</a>.<br />
                            </small>
                        </address>
                    </div>
                </div>
            </div>
            <!-- Bootstrap core JavaScript
                ================================================== -->
            <!-- Placed at the end of the document so the pages load faster -->
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
            <script>window.jQuery || document.write('<script src="./js/vendor/jquery.min.js"><\/script>')</script>
            <script src="../etc/bootstrap/js/bootstrap.min.js"></script>
            <script src="./js/docs.min.js"></script>
            <script LANGUAGE="JavaScript">
                update = new Date(document.lastModified);
                theMonth = update.getMonth() + 1;
                theDate = update.getDate();
                theYear = update.getFullYear();
                theHour = update.getHours();
                theMin = update.getMinutes();
                theSec = update.getSeconds();
                document.write("<strong> Last Modified:</strong> " + theYear + "-" + theMonth + "-" + theDate + "T" + theHour + ":" + theMin + ":" + theSec + "Z");
            </script>
        </div>
    </body>
</html>

