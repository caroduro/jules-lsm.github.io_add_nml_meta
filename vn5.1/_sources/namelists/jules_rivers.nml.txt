``jules_rivers.nml``
====================

This file sets the river routing options. It contains two namelists called :nml:lst:`JULES_RIVERS` and :nml:lst:`JULES_OVERBANK`.

.. note::
   The river routing code in JULES is still in development. Users should ensure that results are as expected, and provide feedback where deficiencies are identified.


``JULES_RIVERS`` namelist members
---------------------------------

.. nml:namelist:: JULES_RIVERS

.. nml:member:: l_rivers

   :type: logical
   :default: F

   Switch for enabling river routing.

   TRUE
       Use the river routing algorithm specified by :nml:mem:`rivers_type` to route runoff along river pathways.

   FALSE
       No river routing.


.. nml:member:: rivers_type

   :type: character
   :default: rfm

   Switch to select the river routing algorithm to use for river routing.

   ``rfm``
       Use a standalone JULES implementation of the RFM kinematic wave model (see Dadson and Bell (2010), Bell et al. (2007)).

   ``trip``
       Use a standalone JULES implementation of the linear TRIP model (see Oki et al. (1999)).

.. nml:member:: rivers_timestep

   :type: integer
   :permitted: > 0
   :default: -32768

   The number of model timesteps per routing timestep.
   
   For example, :nml:mem:`rivers_timestep` = 5 means that runoff will be accumulated for 5 model timesteps before being routed on the 5th timestep.


.. warning::
   The river routing parameter values can be highly dependent on model resolution, so care is required by the user to ensure that appropriate values are selected, tested and adjusted as required.
   
   Suggested values for global and high-resolution runs are listed below, however these should be treated as a starting point.
   
   Values for some typical configurations are included in the ``jules_riversparm`` module. 


.. nml:group:: RFM parameters - used if :nml:mem:`rivers_type` = ``rfm``

   .. nml:member:: cland

      :type: real
      :default: 0.2
      :suggested: 0.2 (global), 0.4 (high-resolution)

      The land wave speed (m s\ :sup:`-1`). See Bell et al. (2007).


   .. nml:member:: criver

      :type: real
      :default: 0.62
      :suggested: 0.62 (global), 0.5 (high-resolution)

      The river wave speed (m s\ :sup:`-1`). See Bell et al. (2007).


   .. nml:member:: cbland

      :type: real
      :permitted: <= :nml:mem:`cland`
      :default: 0.1
      :suggested: 0.1 (global), 0.05 (high-resolution)
      
      The subsurface land wave speed (m s\ :sup:`-1`). See Bell et al. (2007).


   .. nml:member:: cbriver

      :type: real
      :permitted: <= :nml:mem:`criver`
      :default: 0.15
      :suggested: 0.15 (global), 0.05 (high-resolution)

      The subsurface river wave speed (m s\ :sup:`-1`). See Bell et al. (2007).


   .. nml:member:: retl

      :type: real
      :permitted: 0-1
      :default: 0.0

      The (resolution dependent) land return flow fraction. See Bell et al. (2007).
      

   .. nml:member:: retr

      :type: real
      :permitted: 0-1
      :default: 0.005
      :suggested: 0.005 (global), 0.005 (high-resolution)

      The (resolution dependent) river return flow fraction. See Bell et al. (2007).


   .. nml:member:: a_thresh

      :type: integer
      :default: 1
      :suggested: 1 (global), ~10 (high-resolution)

      The threshold drainage area (specified in number of cells) draining to a gridbox, above which the gridbox is considered to be a river point. This is resolution dependent.
      
      Remaining points are treated as land (drainage area = 0) or sea (drainage area < 0). See Bell et al. (2007).


   .. nml:member:: runoff_factor

      :type: real
      :default: 1.0

      **It is highly recommended that this is set to 1.0 (i.e. no runoff adjustment).**
 
 
.. nml:group:: TRIP parameters - used if :nml:mem:`rivers_type` = ``trip``

   .. nml:member:: rivers_speed

      :type: real
      :default: 0.4

      The effective river velocity (m s\ :sup:`-1`). See Oki et al. (1999).
   
   
   .. nml:member:: rivers_meander

      :type: real
      :default: 1.4

      The ratio of the actual to calculated river lengths in a river routing gridbox. See Oki et al. (1999).


.. nml:member:: l_riv_overbank

   :type: logical
   :default: F

   Switch for enabling river overbank inundation. Only used if :nml:mem:`l_rivers` is TRUE. Default setting is FALSE.

   TRUE
      Calculate an overbank inundation gridbox fraction (frac_fplain_lp).

   FALSE
       No overbank inundation calculations
      
      
.. seealso::
   References:
   
      * Bell, V.A. et al. (2007) Development of a high resolution grid-based river flow model for use with regional climate model output. Hydrology and Earth System Sciences. 11 532-549
      * Dadson, S.J. and Bell, V.A. (2010) Comparison of Grid-2-Grid and TRIP runoff routing schemes. Centre for Ecology & Hydrology Internal Report http://nora.nerc.ac.uk/10890/1/dadson_etal_2010_g2gtrip.pdf
      * Dadson S.J. et al. (2011) Evaluation of a grid-based river flow model configured for use in a regional climate model. Journal of Hydrology. 411 238-250
      * Falloon, P.D. et al (2007) New global river routing scheme in the Unified Model. Hadley Centre Technical Note 72, available from `the Met Office Library <http://www.metoffice.gov.uk/learning/library/publications/science/climate-science-technical-notes>`_.
      * Jones R., Dadson, S. and Bell, V.A. (2007) Report on European grid-based river-flow modelling for application to Regional Climate Models. Met Office Hadley Centre deliverable report.
      * Oki, T., et al (1999) Assessment of annual runoff from land surface models using Total Runoff Integrating Pathways (TRIP). Journal of the Meteorological Society of Japan. 77 235-255



``JULES_OVERBANK`` namelist members
-----------------------------------

.. nml:namelist:: JULES_OVERBANK

.. warning::
   The overbank inundation parameter values can be highly dependent on model resolution, so care is required by the user to ensure that appropriate values are selected, tested and adjusted as required.
   
   Suggested values for global and high-resolution runs are listed below, however these should be treated as a starting point only.
   
.. nml:member:: l_riv_hypsometry

   :type: logical
   :default: F

   Switch for enabling use of a hypsometric integral calculation.

   TRUE
       Calculate inundated area from a hypsometric integral (**recommended**).

   FALSE
       Estimate inundated area from river width, ignoring topography (only to be used for testing).


.. nml:group:: River width allometry (used if :nml:mem:`JULES_OVERBANK::l_riv_hypsometry` is false or :nml:mem:`JULES_OVERBANK::use_rosgen` is true)

   Allometry is: (WIDTH in m) = :nml:mem:`riv_a` * ( (SURFACE RIVER INFLOW in m3 s\ :sup:`-1`) ** :nml:mem:`riv_b`) (Leopold & Maddock 1953:eqn1)

   .. nml:member:: riv_a

      :type: real
      :default: 7.20
      :permitted: >=0 and <=(1/:nml:mem:`riv_c`)
      :suggested: 7.20 (global, from Andreadis et al. 2013)

      Coefficient in the allometry for river width (units are (m / ((m3/s)^riv_b)), i.e. dependent on the value of riv_b)

   .. nml:member:: riv_b

      :type: real
      :default: 0.50
      :permitted: >=0 and <=(1-:nml:mem:`riv_f`)
      :suggested: 0.50 (global, from Andreadis et al. 2013)

      Exponent in the allometry for river width (dimensionless)


.. nml:group:: River depth allometry (used if :nml:mem:`JULES_OVERBANK::l_riv_hypsometry` is true or :nml:mem:`JULES_OVERBANK::use_rosgen` is true)

   Allometry is: (DEPTH in m) = :nml:mem:`riv_c` * ( (SURFACE RIVER INFLOW in m3 s\ :sup:`-1`) ** :nml:mem:`riv_f`) (Leopold & Maddock 1953:eqn2)

   .. nml:member:: riv_c

      :type: real
      :default: 0.27
      :permitted: >=0 and <=(1/:nml:mem:`riv_a`)
      :suggested: 0.27 (global, from Andreadis et al. 2013)

      Coefficient in the allometry for river depth (units are (m / ((m3/s)^riv_f)), i.e. dependent on the value of riv_f)

   .. nml:member:: riv_f

      :type: real
      :default: 0.30
      :permitted: >=0 and <=(1-:nml:mem:`riv_b`)
      :suggested: 0.30 (global, from Andreadis et al. 2013)

      Exponent in the allometry for river depth (dimensionless)


.. nml:group:: Rosgen stream classification parameters describing river channel morphology (Rosgen 1994)

   .. nml:member:: use_rosgen

      :type: logical
      :default: F

      Switch for applying the Rosgen entrenchment ratio approach

      TRUE
          When inflow rates are lower than bankfull flow, river width is calculated from the :nml:mem:`riv_a` / :nml:mem:`riv_b` allometry. However, when higher than bankfull flow, river width is constrained so that when river depth = 2 x bankfull depth then width = :nml:mem:`ent_ratio` * bankfull width.

      FALSE
          River width follows the allometry specified above whatever the inflow rate.

   .. nml:group:: Bankfull flow allometry (used if :nml:mem:`use_rosgen` is true)

      Allometry is: (BANKFULL DISCHARGE RATE in m3 s\ :sup:`-1`) = :nml:mem:`coef_b` * ( (CONTRIBUTING AREA in km2) ** :nml:mem:`exp_c` ) (see e.g. Andreadis et al. 2013)

      .. nml:member:: coef_b

         :type: real
         :default: 0.08

         Coefficient in the allometry for bankfull flow

      .. nml:member:: exp_c

         :type: real
         :default: 0.95

         Exponent in the allometry for bankfull flow

   
   .. nml:member:: ent_ratio

      :type: real
      :default: 4.0

      The Rosgen entrenchment ratio (single value for all water courses in the simulation): when river depth = 2 x bankfull depth then width = :nml:mem:`ent_ratio` * bankfull width (i.e. :nml:mem:`ent_ratio` can be used to specify how wide floodplains are allowed to be).


.. seealso::
   References:
   
      * Andreadis KM, Schumann GJ & Pavelsky T (2013). A simple global river bankfull width and depth database. Water Resources Research 49:7164-7168
      * Leopold LB & Maddock T (1953). The Hydraulic Geometry of Stream Channels and Some Physiographic Implications. United States Geological Survey Professional Papers 252:1-57
      * Rosgen DL (1994). A classification of natural rivers. Catena 22:169-199.
